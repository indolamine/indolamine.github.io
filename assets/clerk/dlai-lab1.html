<!DOCTYPE html>
<html><head><meta charset="UTF-8"><meta content="width=device-width, initial-scale=1" name="viewport"><meta content="This notebook is an attempt on recreating the Lab 1 exercises from the Coursera course Generative AI with Large Language Models using Clojure and Clerk.This is mostly for my own benefit, as I&apos;m trying to get more familiar with Clojure&apos;s Python interop and LLM practices in general.  The code uses a lot of Python interop, trying to be as close to the original course&apos;s lab as possible, but the wrapping aims to be idiomatic Clojure (with some success)" property="og:description"><meta content="Lab 1" property="og:title"><meta content="article:clerk" property="og:type"><meta content="summary_large_image" name="twitter:card"><script src="https://cdn.tailwindcss.com?plugins=typography" type="text/javascript"></script><script>tailwind.config = {
  darkMode: "class",
  content: ["./tw/viewer.js", "./tw/**/*.edn"],
  safelist: ['dark'],
  theme: {
    extend: {},
    fontFamily: {
      sans: ["Fira Sans", "-apple-system", "BlinkMacSystemFont", "sans-serif"],
      serif: ["PT Serif", "serif"],
      mono: ["Fira Mono", "monospace"]
    }
  },
  variants: {
    extend: {},
  },
  plugins: [],
}
</script><style type="text/tailwindcss">@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  html {
    font-size: 18px;
  }
  @media (max-width: 600px) {
    html {
      font-size: 16px;
    }
  }
  .font-condensed { font-family: "Fira Sans Condensed", sans-serif; }
  .font-inter     { font-family: "Inter", sans-serif; }
  body {
    @apply font-serif antialiased text-gray-900 sm:overscroll-y-none;
  }
  code, .code {
    @apply font-mono text-sm text-gray-900 bg-slate-50 px-0.5 py-px rounded dark:bg-gray-800;
  }
  code::before, code::after { @apply content-none !important; }
  h1, h3, h4, h5, h6 {
    @apply font-condensed font-bold mt-8 first:mt-0;
  }
  h2 {
    /*We cannot collapse margins due to nesting but we want to*/
    /*keep the h2’s large margin visible*/
    @apply font-condensed font-bold mt-8 first:mt-2;
  }
  h1 { @apply text-4xl; }
  h2 { @apply text-3xl; }
  h3 { @apply text-2xl; }

  @media print {
      h1 { @apply text-2xl !important; }
      h2 { @apply text-xl !important; }
      h3 { @apply text-lg !important; }
  }

  button { @apply focus:outline-none; }
  strong { @apply font-bold; }
  em     { @apply italic; }
  pre    { @apply m-0 font-mono; }
  table img { @apply inline-block; }
}

/* Compatibility */
/* --------------------------------------------------------------- */
/* TODO: Verify which colors are in use and replace with Tailwind
   colors accordingly. Move Nj-specific styles out of here. */

:root {
  --teal-color: #31afd0;
  --dark-teal-color: #095960;
  --near-black-color: #2e2e2c;
  --red-color: #d64242;
  --dark-blue-color: #1f2937;
  --dark-blue-60-color: rgba(28, 42, 56, 0.6);
  --gray-panel-color: rgba(239, 241, 245, 1.000);
  --brand-color: var(--dark-blue-color);
  --link-color: #5046e4;
  --command-bar-selected-color: var(--teal-color);
}

.serif      { @apply font-serif; }
.sans-serif { @apply font-sans; }
.monospace  { @apply font-mono; }
.inter      { @apply font-inter; }

.border-color-teal { border-color: var(--dark-teal-color); }
.teal { color: var(--teal-color); }
.bg-dark-blue { background: var(--dark-blue-color); }
.bg-dark-blue-60 { background: rgba(28, 42, 56, 0.6); }
.bg-gray-panel { background: var(--gray-panel-color); }
.text-dark-blue  { color: var(--dark-blue-color); }
.text-dark-blue-60 { color: var(--dark-blue-60-color); }
.border-dark-blue-30 { border-color: rgba(28, 42, 56, 0.6); }
.text-brand { color: var(--dark-blue-color); }
.bg-brand { background: var(--dark-blue-color); }
.text-selected { color: white; }
.red { color: var(--red-color); }

/* Disclose Button */
/* --------------------------------------------------------------- */

.disclose {
  @apply content-none border-solid cursor-pointer inline-block relative mr-[3px] top-[-2px] transition-all;
  border-color: var(--near-black-color) transparent;
  border-width: 6px 4px 0;
}
.disclose:hover {
  border-color: var(--near-black-color) transparent;
}
.dark .disclose,
.dark .disclose:hover {
  border-color: white transparent;
}
.disclose.collapsed {
  @apply rotate-[-90deg];
}

/* Layout */
/* --------------------------------------------------------------- */

.page {
  @apply max-w-5xl mx-auto px-12 box-border flex-shrink-0;
}
.max-w-prose { @apply max-w-[46rem] !important; }
.max-w-wide  { @apply max-w-3xl !important; }

/* List Styles */
/* --------------------------------------------------------------- */

.task-list-item + .task-list-item,
.markdown-viewer ul ul {
  @apply mt-1 mb-0;
}

/* compact TOC */
.markdown-viewer .toc ul {
  list-style: none;
  @apply my-1;
}

/* Code Viewer */
/* --------------------------------------------------------------- */

.code-viewer {
  @apply font-mono bg-slate-100 rounded-sm text-sm overflow-x-auto dark:bg-gray-800;
}
.code-listing  {
    @apply -ml-8 -mr-8 relative !important;
}
.code-viewer .cm-content {
  @apply py-4 px-8;
}
@media (min-width: 960px){
    .notebook-viewer .code-viewer .cm-content {
        @apply pb-2 pl-12;
    }
    .notebook-viewer .code-listing {
        width: 48rem !important;
        @apply -ml-12 mr-0 !important;
    }
}
/* Don’t show focus outline when double-clicking cell in Safari */
.cm-scroller { @apply focus:outline-none; }

/* Syntax Highlighting */
/* --------------------------------------------------------------- */

.inspected-value { @apply text-xs font-mono leading-[1.25rem]; }
.cmt-strong, .cmt-heading { @apply font-bold; }
.cmt-italic, .cmt-emphasis { @apply italic; }
.cmt-strikethrough { @apply line-through; }
.cmt-link { @apply underline; }
.untyped-value { @apply whitespace-nowrap; }

.cm-editor, .cmt-default, .result-viewer {
  @apply text-slate-800 dark:text-slate-300;
}
.cmt-keyword {
  @apply text-purple-800 dark:text-pink-400;
}
.cmt-atom, .cmt-bool, .cmt-url, .cmt-contentSeparator, .cmt-labelName {
  @apply text-blue-900 dark:text-blue-300;
}
.cmt-inserted, .cmt-literal {
  @apply text-emerald-700 dark:text-emerald-200;
}
.cmt-string, .cmt-deleted {
  @apply text-rose-700 dark:text-sky-300;
}
.cmt-italic.cmt-string {
  @apply dark:text-sky-200;
}
.cmt-regexp, .cmt-escape {
  @apply text-orange-500 dark:text-orange-300;
}
.cmt-variableName {
  @apply text-blue-800 dark:text-sky-300;
}
.cmt-typeName, .cmt-namespace {
  @apply text-emerald-600 dark:text-emerald-300;
}
.cmt-className {
  @apply text-teal-600 dark:text-teal-200;
}
.cmt-macroName {
  @apply text-teal-700 dark:text-teal-200;
}
.cmt-propertyName {
  @apply text-blue-700 dark:text-blue-200;
}
.cmt-comment {
  @apply text-slate-500 dark:text-slate-400;
}
.cmt-meta {
  @apply text-slate-600 dark:text-slate-400;
}
.cmt-invalid {
  @apply text-red-500 dark:text-red-300;
}

.result-data {
  @apply font-mono text-sm overflow-x-auto whitespace-nowrap leading-normal;
}
.result-data::-webkit-scrollbar, .path-nav::-webkit-scrollbar {
  @apply h-0;
}
.result-data-collapsed {
  @apply whitespace-nowrap;
}
.result-data-field {
  @apply ml-4 whitespace-nowrap;
}
.result-data-field-link{
  @apply ml-4 whitespace-nowrap cursor-pointer;
}
.result-data-field-link:hover {
  @apply text-black bg-black/5;
}
.result-text-empty {
  color: rgba(0,0,0,.3);
}
.browsify-button:hover {
  box-shadow: -2px 0 0 2px #edf2f7;
}

/* Prose */
/* --------------------------------------------------------------- */

.notebook-viewer,
.markdown-viewer {
  @apply prose
    dark:prose-invert
    prose-a:text-blue-600 prose-a:no-underline hover:prose-a:underline
    dark:prose-a:text-blue-300
    prose-p:mt-4 prose-p:leading-snug
    prose-ol:mt-4 prose-ol:mb-6 prose-ol:leading-snug
    prose-ul:mt-4 prose-ul:mb-6 prose-ul:leading-snug
    prose-blockquote:mt-4 prose-blockquote:leading-snug
    prose-hr:mt-6 prose-hr:border-t-2 prose-hr:border-solid prose-hr:border-slate-200
    prose-figure:mt-4
    prose-figcaption:mt-2 prose-figcaption:text-xs
    prose-headings:mb-4
    prose-table:mt-0
    prose-th:mb-0
    prose-img:my-0
    prose-code:font-medium prose-code:bg-slate-100
    max-w-none;
}
.markdown-viewer blockquote p:first-of-type:before,
.markdown-viewer blockquote p:last-of-type:after {
  @apply content-none;
}
.markdown-node-viewer.result-viewer.fragment-item {
    @apply mb-0 !important;
}

/* Images */
/* --------------------------------------------------------------- */


/* Todo Lists */
/* --------------------------------------------------------------- */

.contains-task-list {
  @apply pl-6 list-none;
}
.contains-task-list input[type="checkbox"] {
  @apply appearance-none h-4 w-4 rounded border border-slate-200 relative mr-[0.3rem] ml-[-1.5rem] top-[0.15rem];
}
.contains-task-list input[type="checkbox"]:checked {
  @apply border-indigo-600 bg-indigo-600 bg-no-repeat bg-contain;
  background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e");
}

/* Markdown TOC */
/* --------------------------------------------------------------- */

.markdown-viewer .toc      { @apply mt-4; }
.markdown-viewer h1 + .toc { @apply mt-8; }

.markdown-viewer .toc h1,
.markdown-viewer .toc h2,
.markdown-viewer .toc h3,
.markdown-viewer .toc h4,
.markdown-viewer .toc h5,
.markdown-viewer .toc h6 {
  @apply text-base text-indigo-600 font-sans my-0;
}
.markdown-viewer .toc a {
  @apply text-indigo-600 font-normal no-underline hover:underline;
}
.markdown-viewer .toc li    { @apply m-0; }
.markdown-viewer .toc ul ul { @apply pl-4; }

/* Notebook Spacing */
/* --------------------------------------------------------------- */

.markdown-viewer *:first-child:not(.code-viewer):not(li):not(h2):not(.sidenote) { @apply mt-0; }
/*.viewer + .viewer { @apply mt-6; }*/
.viewer + .result-viewer { @apply mt-0; }
.code-viewer + .result-viewer { @apply mt-3; }
.markdown-viewer + .markdown-viewer { @apply mt-0; }

/* Sidenotes */
/* --------------------------------------------------------------- */

.sidenote-ref {
  @apply top-[-0.5em] w-auto h-auto inline border-0 bg-transparent m-0 pointer-events-none;
}
.sidenote {
  @apply block font-sans text-xs mt-4 bg-slate-100 dark:bg-slate-800 p-4;
  font-style: normal;
  font-weight: normal;
}
.sidenote-container {
  @apply mb-4;
}
@media (min-width: 860px) {
  .sidenote sup { @apply inline; }
  .sidenote-column {
    @apply w-[165px] absolute right-0 top-0 -mr-[205px];
  }
  .sidenote {
    @apply bg-transparent dark:bg-transparent p-0;
  }
  .sidenote:first-child {
    @apply mt-1;
  }
  .sidenotes-layout .markdown-viewer {
    @apply pr-[241px];
  }
  .sidenote-container {
    @apply relative mb-0;
  }
  .sidenotes-layout h1 {
    @apply w-[756px] !important;
  }
}
.code-viewer + .viewer:not(.code-viewer):not(.code-viewer-folded),
.code-viewer-folded + .viewer:not(.code-viewer):not(.code-viewer-folded),
.result-viewer:not(.markdown-node-viewer) + .result-viewer {
  @apply mt-2;
}
.code-viewer + .code-viewer-folded {
  @apply mt-4;
}
.result-viewer {
  @apply leading-tight mb-6;
}
.code-viewer.fragment-item.result-viewer {
  @apply mb-0 !important;
}
.result-viewer figure {
  @apply mt-0 !important;
}
@media (min-width: 768px) {
  .devcard-desc > div {
    @apply max-w-full m-0;
  }
}

/* Command Palette */
/* --------------------------------------------------------------- */

.nj-commands-input {
  @apply bg-transparent text-white;
}
.nj-context-menu-item:hover:not([disabled]) {
  @apply cursor-pointer;
  background-color: rgba(255,255,255,.14);
}

/* Devdocs */
/* --------------------------------------------------------------- */

.logo, .logo-white {
  @apply block indent-[-999em];
  background: url(/images/nextjournal-logo.svg) center center no-repeat;
}
.devdocs-body {
  @apply font-inter;
}

/* Workarounds */
/* --------------------------------------------------------------- */

/* Fixes vega viewer resizing into infinity */
.vega-embed .chart-wrapper { @apply h-auto !important; }
/* fixes fraction separators being overridden by tw’s border-color */
.katex * { @apply border-black; }

@media print {
    .dark-mode-toggle,
    .toc-toggle { @apply hidden; }
    .notebook-viewer { @apply pt-0; font-size: 12pt !important; margin-left: 0 !important; }
    .code-viewer .cm-content,
    .viewer-code .cm-content { @apply whitespace-pre-wrap !important; overflow: none; }
    .code-viewer .cm-line { font-size: 12pt !important; }
    html * { page-break-inside: avoid !important; }
    .toc-panel { @apply hidden; }
}
</style><script src="https://storage.clerk.garden/nextjournal/clerk-assets@Me6c4a1aFwAPMjnGU96CERc3zTT/viewer.js?immutable=true" type="module"></script><link href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" rel="stylesheet" type="text/css"><link href="https://fonts.bunny.net" rel="preconnect"><link href="https://fonts.bunny.net/css?family=fira-mono:400,700%7Cfira-sans:400,400i,500,500i,700,700i%7Cfira-sans-condensed:700,700i%7Cpt-serif:400,400i,700,700i" rel="stylesheet" type="text/css"></head><body class="dark:bg-gray-900"><div id="clerk"></div><script type="module">let viewer = nextjournal.clerk.sci_env
let state = "{:bundle? false, :path->doc {\"src/dlai/lab1.clj\" {:path [], :nextjournal/value {:toc {:type :toc, :children [{:type :toc, :content [{:type :text, :text \"Lab 1\"}], :heading-level 1, :attrs {:id \"lab-1\"}, :path [:content 0], :children [{:type :toc, :content [{:type :text, :text \"👋 Introduction\"}], :heading-level 2, :attrs {:id \"introduction\"}, :emoji \"👋\", :path [:content 1]} {:type :toc, :content [{:type :text, :text \"⚒️ Setup\"}], :heading-level 2, :attrs {:id \"setup\"}, :emoji \"⚒️\", :path [:content 4]} {:type :toc, :content [{:type :text, :text \"📀 Grab some data\"}], :heading-level 2, :attrs {:id \"grab-some-data\"}, :emoji \"📀\", :path [:content 8]} {:type :toc, :content [{:type :text, :text \"🕵️ First look into our data\"}], :heading-level 2, :attrs {:id \"first-look-into-our-data\"}, :emoji \"🕵️\", :path [:content 10]} {:type :toc, :content [{:type :text, :text \"🏰 On to the Large Language Model\"}], :heading-level 2, :attrs {:id \"on-to-the-large-language-model\"}, :emoji \"🏰\", :path [:content 18], :children [{:type :toc, :content [{:type :text, :text \"🪙 Tokenizer setup\"}], :heading-level 3, :attrs {:id \"tokenizer-setup\"}, :emoji \"🪙\", :path [:content 20]} {:type :toc, :content [{:type :text, :text \"⚙️ Model machinery setup\"}], :heading-level 3, :attrs {:id \"model-machinery-setup\"}, :emoji \"⚙️\", :path [:content 24]}]} {:type :toc, :content [{:type :text, :text \"🗜️ Summarization\"}], :heading-level 2, :attrs {:id \"summarization\"}, :emoji \"🗜️\", :path [:content 29], :children [{:type :toc, :content [{:type :text, :text \"👩‍🔧 Prompt engineering\"}], :heading-level 3, :attrs {:id \"prompt-engineering\"}, :emoji \"👩‍🔧\", :path [:content 33]} {:type :toc, :content [{:type :text, :text \"⚖️ Comparing results\"}], :heading-level 3, :attrs {:id \"comparing-results\"}, :emoji \"⚖️\", :path [:content 40]} {:type :toc, :content [{:type :text, :text \"🔫 One-shot and few-shot\"}], :heading-level 3, :attrs {:id \"one-shot-and-few-shot\"}, :emoji \"🔫\", :path [:content 46]}]} {:type :toc, :content [{:type :text, :text \"🎬 The big finale\"}], :heading-level 2, :attrs {:id \"the-big-finale\"}, :emoji \"🎬\", :path [:content 54]}]}]}, :sidenotes? false, :toc-visibility true, :atom-var-name->state #viewer-eval (nextjournal.clerk.render/intern-atoms! {}), :ns #viewer-eval (ns dlai.lab1), :scope dlai.lab1, :bundle? false, :header {:path [], :nextjournal/value [:div.viewer.w-full.max-w-prose.px-8.not-prose.mt-3 [:div.mb-8.text-xs.sans-serif.text-slate-400 nil nil [:span \"Generated with \" [:a.font-medium.border-b.border-dotted.border-slate-300.hover:text-indigo-500.hover:border-indigo-500.dark:border-slate-500.dark:hover:text-white.dark:hover:border-white.transition {:href \"https://clerk.vision\"} \"Clerk\"] \" from \" [:a.font-medium.border-b.border-dotted.border-slate-300.hover:text-indigo-500.hover:border-indigo-500.dark:border-slate-500.dark:hover:text-white.dark:hover:border-white.transition {:href nil} \"src/dlai/lab1.clj\" nil]]]], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}, :open-graph {:type \"article:clerk\", :title \"Lab 1\", :description \"This notebook is an attempt on recreating the Lab 1 exercises from the Coursera course Generative AI with Large Language Models using Clojure and Clerk.This is mostly for my own benefit, as I'm trying to get more familiar with Clojure's Python interop and LLM practices in general.  The code uses a lot of Python interop, trying to be as close to the original course's lab as possible, but the wrapping aims to be idiomatic Clojure (with some success)\"}, :title \"Lab 1\", :blocks [{:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.user/markdown-5dtXqG2L3MHmwqwWMCCrM8GyNcm3nR\"} [\"h1\" {:id \"lab-1\"} [:<> \"Lab 1\"]] [\"h2\" {:id \"introduction\"} [:<> \"👋 Introduction\"]] [:p [:<> \"This notebook is an attempt on recreating the Lab 1 exercises from\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"the Coursera course \"] [:a {:href \"https://www.coursera.org/learn/generative-ai-with-llms/home/welcome\"} [:<> \"Generative AI with Large Language Models\"]] [:<> \" using Clojure and Clerk.\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:br], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"This is mostly for my own benefit, as I'm trying to get more familiar with Clojure's Python interop and LLM practices in general.  \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:br], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"The code uses a lot of Python interop, trying to be as close to the original course's lab as possible, but the wrapping aims to be idiomatic Clojure (with some success)\"]] [:p [:<> \"The original, Jupyter notebook of this lab can be grabbed from s3 via\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:br], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:code [:<> \"aws s3 cp --recursive s3://dlai-generative-ai/labs/w1-549876/ ./\"]]] [\"h2\" {:id \"setup\"} [:<> \"⚒️ Setup\"]] [:p [:<> \"We'll require stuff for Python interop from \"] [:a {:href \"https://github.com/clj-python/libpython-clj/tree/master\"} [:<> \"libpython-clj\"]] [:<> \", \"] [:code [:<> \"clojure.set\"]] [:<> \" for some set manipulation later, and \"] [:a {:href \"https://clerk.vision\"} [:<> \"Clerk\"]] [:<> \" for the Notebook experience.\"]]], :nextjournal/opts {:id \"dlai.user/markdown-5dtXqG2L3MHmwqwWMCCrM8GyNcm3nR\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(ns dlai.lab1\\n  {:nextjournal.clerk/toc true}\\n  (:require [libpython-clj2.require :refer [require-python]]\\n            [libpython-clj2.python :refer [py. py.. py.-] :as py]\\n            [clojure.set :as set]\\n            [nextjournal.clerk :as clerk]\\n            [nextjournal.clerk.viewer :as v]))\", :nextjournal/opts {:loc {:line 13, :end-line 20, :column 1, :end-column 47}, :id \"dlai.lab1/anon-expr-5dtSjUzRnzhfcbEsH7Tfn3MUWM3Z1G-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5dsVz4sJYFQiXZukCZ4QeoKeQvCavR\"} [:p [:<> \"We'll also need to load some Python libraries as does the original lab. Note, that most probably there are Clojure implementations for a lot of the features we'll use, but I didn't go down that route.\"]] [:p [:<> \"These are libraries from 🤗 \"] [:a {:href \"https://huggingface.co/\"} [:<> \"HuggingFace\"]]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5dsVz4sJYFQiXZukCZ4QeoKeQvCavR\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(require-python 'datasets)\", :nextjournal/opts {:loc {:line 26, :end-line 27, :column 1, :end-column 27}, :id \"dlai.lab1/anon-expr-5ds5Ghpei6zu5kQV4ZkfLEAb7z6PsB-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value \"(py/from-import transformers AutoModelForSeq2SeqLM)\", :nextjournal/opts {:loc {:line 28, :end-line 29, :column 1, :end-column 52}, :id \"dlai.lab1/anon-expr-5dsfJadUZbfQ4DqiHcqnsFURg6ZaV8-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value \"(py/from-import transformers AutoTokenizer)\", :nextjournal/opts {:loc {:line 30, :end-line 31, :column 1, :end-column 44}, :id \"dlai.lab1/anon-expr-5drSjboAeHaryXZ4fJkFuV2C8m54sz-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value \"(py/from-import transformers GenerationConfig)\", :nextjournal/opts {:loc {:line 32, :end-line 33, :column 1, :end-column 47}, :id \"dlai.lab1/anon-expr-5dscUxktAktWPYraJKufbwsi1ujFgE-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value \"(def datasets (py/import-module \\\"datasets\\\"))\", :nextjournal/opts {:loc {:line 34, :end-line 35, :column 1, :end-column 45}, :id \"dlai.lab1/datasets-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5drfh4Jfx91LAWfcv21wttMJQWtpCH\"} [\"h2\" {:id \"grab-some-data\"} [:<> \"📀 Grab some data\"]] [:p [:<> \"First, let's use the \"] [:code [:<> \"datasets\"]] [:<> \" library to grab a public dataset from HuggingFace. We'll \"] [:code [:<> \"defonce\"]] [:<> \" this, as upon namespace re-evaluations, either from the REPL or via Clerk, we don't want the download and processing to happen over and over again.\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:br], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"As you'll hear in the course, this dataset contains dialogues, and their human-written summaries. What the lab will do is to play around with an LLM and use it for summarization, using different prompting approaches.\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5drfh4Jfx91LAWfcv21wttMJQWtpCH\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(defonce dataset (py/py.. datasets (load_dataset  \\\"knkarthick/dialogsum\\\")))\", :nextjournal/opts {:loc {:line 41, :end-line 41, :column 1, :end-column 76}, :id \"dlai.lab1/dataset-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"DatasetDict({\\n    train: Dataset({\\n        features: ['id', 'dialogue', 'summary', 'topic'],\\n        num_rows: 12460\\n    })\\n    validation: Dataset({\\n        features: ['id', 'dialogue', 'summary', 'topic'],\\n        num_rows: 500\\n    })\\n    test: Dataset({\\n        features: ['id', 'dialogue', 'summary', 'topic'],\\n        num_rows: 1500\\n    })\\n})\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (nextjournal.clerk.viewer/read-string-without-tag-table x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5drLf4DPk2fvabdwZEx7quFkceCsMD\"}, :nextjournal/opts {:id \"dlai.lab1/dataset-result\"}}, :nextjournal/blob-id \"5dtejXJJsz73SAcbLPSrTqcDiPCdFy\"}, :nextjournal/opts {:id \"dlai.lab1/dataset-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5ds4HXfjgTNzHyxSK56qZebhT6HXv5\"} [\"h2\" {:id \"first-look-into-our-data\"} [:<> \"🕵️ First look into our data\"]] [:p [:<> \"At this point we have our data, let's see what's in there.\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:br], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"What type even is this?\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5ds4HXfjgTNzHyxSK56qZebhT6HXv5\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(type dataset)\", :nextjournal/opts {:loc {:line 46, :end-line 46, :column 1, :end-column 15}, :id \"dlai.lab1/anon-expr-5dtsFsh61Dq77KM5oXL5bb6CxcPW3E-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value :pyobject, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dty7b5oeWwc4BNN5fnBZPTMCqbFBY\"}, :nextjournal/opts {:id \"dlai.lab1/anon-expr-5dtsFsh61Dq77KM5oXL5bb6CxcPW3E-result\"}}, :nextjournal/blob-id \"5drE817DyrYUhBErQ27LNfVWLSBz2q\"}, :nextjournal/opts {:id \"dlai.lab1/anon-expr-5dtsFsh61Dq77KM5oXL5bb6CxcPW3E-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5ds47ccNhdCBv9s8Zzubjvv9FDHwG9\"} [:p [:<> \"So, this is a :pyobject that we'll need introp-ing with. Let's try.\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"First, let's get a string representation of what's in there. This is pretty useful to get a sense of what this datastructure actually is.\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"We'll use Clerk's code viewer for displaying this as preformatted data.\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5ds47ccNhdCBv9s8Zzubjvv9FDHwG9\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(str dataset)\", :nextjournal/opts {:loc {:line 53, :end-line 54, :column 1, :end-column 14}, :id \"dlai.lab1/anon-expr-5dt4P8b2ehrVF9UqP3tUEUauDTZiht-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"DatasetDict({\\n    train: Dataset({\\n        features: ['id', 'dialogue', 'summary', 'topic'],\\n        num_rows: 12460\\n    })\\n    validation: Dataset({\\n        features: ['id', 'dialogue', 'summary', 'topic'],\\n        num_rows: 500\\n    })\\n    test: Dataset({\\n        features: ['id', 'dialogue', 'summary', 'topic'],\\n        num_rows: 1500\\n    })\\n})\", :nextjournal/visibility {:code :show, :result :show}, :nextjournal/opts {:language \"clojure\", :id \"dlai.lab1/anon-expr-5dt4P8b2ehrVF9UqP3tUEUauDTZiht-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}}, :nextjournal/blob-id \"5drPLxzjLoxp5JjaSZe4bCtu1KN6yU\"}, :nextjournal/visibility {:code :show, :result :show}, :nextjournal/opts {:language \"clojure\", :id \"dlai.lab1/anon-expr-5dt4P8b2ehrVF9UqP3tUEUauDTZiht-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5dtjv31J82vU7cRf5UGK3kpRNZt1Tz\"} [:p [:<> \"Okay, so this is a DatasetDict, that contains three Datasets, \"] [:code [:<> \"train\"]] [:<> \", \"] [:code [:<> \"validation\"]] [:<> \" and \"] [:code [:<> \"test\"]] [:<> \". Well prepared for actual model training (that we won't do as of yet).\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:br], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"We'll be playing with the \"] [:code [:<> \"test\"]] [:<> \" portion of the set.\"]] [:p [:<> \"Again using some introp, let's take a look at some data in there - let's see what is the summary (human written) of the first dialog in the test dataset.\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:br], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"But first let's define a Clerk viewer to make this display nicely\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5dtjv31J82vU7cRf5UGK3kpRNZt1Tz\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(def text-viewer\\n  {:transform-fn\\n   (clerk/update-val\\n    #(clerk/html\\n      [:pre.font-sans.text-xs.drop-shadow-lg.p-6.rounded\\n       {:style {:white-space \\\"pre-wrap\\\"}}\\n       %]))})\", :nextjournal/opts {:loc {:line 62, :end-line 69, :column 1, :end-column 14}, :id \"dlai.lab1/text-viewer-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5dtyGshJyZ5a3eSXK4Vr7eUVLpdx24\"} [:p [:<> \"and now use it\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5dtyGshJyZ5a3eSXK4Vr7eUVLpdx24\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(-> dataset\\n    (py/get-item \\\"test\\\")\\n    (py/get-item 1)\\n    (py/get-item \\\"summary\\\"))\", :nextjournal/opts {:loc {:line 71, :end-line 75, :column 1, :end-column 29}, :id \"dlai.lab1/anon-expr-5duFnBRJnQ4kskQ8HFrXsLAzcUpuGA-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value [:pre.font-sans.text-xs.drop-shadow-lg.p-6.rounded {:style {:white-space \"pre-wrap\"}} \"In order to prevent employees from wasting time on Instant Message programs, #Person1# decides to terminate the use of those programs and asks Ms. Dawson to send out a memo to all employees by the afternoon.\"], :nextjournal/visibility {:code :show, :result :show}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}, :nextjournal/opts {:id \"dlai.lab1/anon-expr-5duFnBRJnQ4kskQ8HFrXsLAzcUpuGA-result\"}}, :nextjournal/blob-id \"5drGwPEAGDLDiUZD261Dnoxqfk6XY7\"}, :nextjournal/visibility {:code :show, :result :show}, :nextjournal/opts {:id \"dlai.lab1/anon-expr-5duFnBRJnQ4kskQ8HFrXsLAzcUpuGA-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5draDT3mGQ3ybQJkGfQdstwR9AU297\"} [:p [:<> \"This way of getting to data is really cumbersome, let's write a small convenience function that will help us get down the tree of Python objects' \"] [:code [:<> \"items\"]] [:<> \", in the stye of \"] [:code [:<> \"clojure.core/get-in\"]] [:<> \".\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:br], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"This is where I need to admit that I'm pretty sure this already exists in the Python-interop code somewhere, but it was just easier to build this than to find it - laaazy 🙃.\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5draDT3mGQ3ybQJkGfQdstwR9AU297\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(defn get-in-items\\n  \\\"Takes a Python object and a sequence of path fragments, traverses the object's items using\\n  the given path and returns the thing found there\\\"\\n  [pyobj path]\\n  (loop [item pyobj\\n         remaining-path path]\\n    (if (empty? remaining-path)\\n      item\\n      (recur (py/get-item item (first remaining-path)) (rest remaining-path)))))\", :nextjournal/opts {:loc {:line 80, :end-line 89, :column 1, :end-column 81}, :id \"dlai.lab1/get-in-items-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5dsUNCKMUtcxdc4RVH3nH8GgqbzwG3\"} [:p [:<> \"And now let's use this to get the dialog of the same dataset item\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5dsUNCKMUtcxdc4RVH3nH8GgqbzwG3\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(get-in-items dataset [\\\"test\\\" 1 \\\"dialogue\\\"])\", :nextjournal/opts {:loc {:line 93, :end-line 94, :column 1, :end-column 45}, :id \"dlai.lab1/anon-expr-5dr9sTRqB9p9EESiGbnUBhAiDjHvLY-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value [:pre.font-sans.text-xs.drop-shadow-lg.p-6.rounded {:style {:white-space \"pre-wrap\"}} \"#Person1#: Ms. Dawson, I need you to take a dictation for me.\\n#Person2#: Yes, sir...\\n#Person1#: This should go out as an intra-office memorandum to all employees by this afternoon. Are you ready?\\n#Person2#: Yes, sir. Go ahead.\\n#Person1#: Attention all staff... Effective immediately, all office communications are restricted to email correspondence and official memos. The use of Instant Message programs by employees during working hours is strictly prohibited.\\n#Person2#: Sir, does this apply to intra-office communications only? Or will it also restrict external communications?\\n#Person1#: It should apply to all communications, not only in this office between employees, but also any outside communications.\\n#Person2#: But sir, many employees use Instant Messaging to communicate with their clients.\\n#Person1#: They will just have to change their communication methods. I don't want any - one using Instant Messaging in this office. It wastes too much time! Now, please continue with the memo. Where were we?\\n#Person2#: This applies to internal and external communications.\\n#Person1#: Yes. Any employee who persists in using Instant Messaging will first receive a warning and be placed on probation. At second offense, the employee will face termination. Any questions regarding this new policy may be directed to department heads.\\n#Person2#: Is that all?\\n#Person1#: Yes. Please get this memo typed up and distributed to all employees before 4 pm.\"], :nextjournal/visibility {:code :show, :result :show}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}, :nextjournal/opts {:id \"dlai.lab1/anon-expr-5dr9sTRqB9p9EESiGbnUBhAiDjHvLY-result\"}}, :nextjournal/blob-id \"5drYYmiRZfUKzc2UTrrfVnXvqwTAKj\"}, :nextjournal/visibility {:code :show, :result :show}, :nextjournal/opts {:id \"dlai.lab1/anon-expr-5dr9sTRqB9p9EESiGbnUBhAiDjHvLY-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5dtcpnm6og3jd8wXYXdU3uHLTo5K6f\"} [\"h2\" {:id \"on-to-the-large-language-model\"} [:<> \"🏰 On to the Large Language Model\"]] [:p [:<> \"Load the model and the corresponding tokenizer via HuggingFace's utility functions\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"We'll be using the T5 base model from Google.\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:br], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"The code below will download the model from HuggingFace, initialize it for using for completions (Seq2Seq, meaning taking a piece of text and outputting a piece of text pretty much), and also sets up a tokenizer that takes care of turing text into a model-internal token representation and back as needed.\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5dtcpnm6og3jd8wXYXdU3uHLTo5K6f\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(def model-name \\\"google/flan-t5-base\\\")\", :nextjournal/opts {:loc {:line 99, :end-line 100, :column 1, :end-column 39}, :id \"dlai.lab1/model-name-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value \"(defonce model\\n  (py. AutoModelForSeq2SeqLM from_pretrained model-name))\", :nextjournal/opts {:loc {:line 101, :end-line 103, :column 1, :end-column 58}, :id \"dlai.lab1/model-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value \"(defonce tokenizer\\n  (py. AutoTokenizer from_pretrained model-name :use_fast true))\", :nextjournal/opts {:loc {:line 104, :end-line 106, :column 1, :end-column 65}, :id \"dlai.lab1/tokenizer-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5dstREzhnKb5GsYzfGXFou8BitRv2S\"} [\"h3\" {:id \"tokenizer-setup\"} [:<> \"🪙 Tokenizer setup\"]] [:p [:<> \"Next, we'll define some helpers for tokenizing and untokenizing text\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5dstREzhnKb5GsYzfGXFou8BitRv2S\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(defn tokenize\\n  \\\"Tokenizes the string using the tokenizer\\\"\\n  [str tokenizer]\\n  (tokenizer str :return_tensors \\\"pt\\\"))\", :nextjournal/opts {:loc {:line 111, :end-line 115, :column 1, :end-column 40}, :id \"dlai.lab1/tokenize-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value \"(defn untokenize\\n  \\\"Takes a tensor and a tokenizer, decodes the tensor using the tokenizer's decoder function\\\"\\n  [x tokenizer]\\n  (py/$a tokenizer decode x :skip_special_tokens true))\", :nextjournal/opts {:loc {:line 117, :end-line 121, :column 1, :end-column 56}, :id \"dlai.lab1/untokenize-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5dr2WJ7eoHJV3dPSSKRrdBFxTvdoJX\"} [:p [:<> \"Let's test the tokenizer via doing a roundtrip\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5dr2WJ7eoHJV3dPSSKRrdBFxTvdoJX\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(def sentence-encoded (tokenize \\\"Clojure is soooo coool for AI!\\\" tokenizer))\", :nextjournal/opts {:loc {:line 124, :end-line 125, :column 1, :end-column 77}, :id \"dlai.lab1/sentence-encoded-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"{'input_ids': tensor([[ 8932, 10609,    15,    19,     3,     7, 16780,   576,    32,    32,\\n            40,    21,  7833,    55,     1]]), 'attention_mask': tensor([[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]])}\", :nextjournal/visibility {:code :show, :result :show}, :nextjournal/opts {:language \"clojure\", :id \"dlai.lab1/sentence-encoded-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}}, :nextjournal/blob-id \"5drgDPjrzdMsRuyeq371M5X6aEfBUL\"}, :nextjournal/visibility {:code :show, :result :show}, :nextjournal/opts {:language \"clojure\", :id \"dlai.lab1/sentence-encoded-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def sentence-decoded (untokenize (get-in-items sentence-encoded [\\\"input_ids\\\" 0]) tokenizer))\", :nextjournal/opts {:loc {:line 126, :end-line 126, :column 1, :end-column 94}, :id \"dlai.lab1/sentence-decoded-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"Clojure is soooo coool for AI!\", :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-quoted-string, :opening-paren \"\\\"\", :closing-paren (\"\\\"\"), :page-size 80, :hash \"5dsc8hKzdYc787YrnnWStEqLBFykdE\"}, :nextjournal/opts {:id \"dlai.lab1/sentence-decoded-result\"}}, :nextjournal/blob-id \"5droBz1YtiuVyoPjZ9uRXVya39AmYX\"}, :nextjournal/opts {:id \"dlai.lab1/sentence-decoded-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5drNwLUvDTdPNvXqA61vadpThdqA9x\"} [:p [:<> \"Looking good 👍, the tokenizer-untokenizer seems to work.\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"But, this is just logistics, the actual model was no involved yet.\"]] [\"h3\" {:id \"model-machinery-setup\"} [:<> \"⚙️ Model machinery setup\"]] [:p [:<> \"Now, set up some machinery to actually use the model to generate response.\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5drNwLUvDTdPNvXqA61vadpThdqA9x\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(defn generate-response\\n  \\\"Takes a model, a tokenizer and a prompt, uses model to create completion and return response text\\\"\\n  [model tokenizer prompt]\\n  (let [input-for-model (-> prompt\\n                            (tokenize tokenizer)\\n                            (get-in-items [\\\"input_ids\\\"]))\\n        generated-response (py/$a model generate input-for-model\\n                                  :max_new_tokens 50\\n                                  :do_sample true\\n                                  :temperature 0.1)]\\n    (untokenize (get-in-items generated-response [0]) tokenizer)))\", :nextjournal/opts {:loc {:line 134, :end-line 145, :column 1, :end-column 67}, :id \"dlai.lab1/generate-response-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5drqvfGAHyNJdtMyEvGnTWvjpCoykq\"} [:p [:<> \"And now 🥁... let's talk to our LLM\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5drqvfGAHyNJdtMyEvGnTWvjpCoykq\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(generate-response model tokenizer \\\"What is the coolest programming language?\\\")\", :nextjournal/opts {:loc {:line 149, :end-line 149, :column 1, :end-column 80}, :id \"dlai.lab1/anon-expr-5drVmYhMUkDbQVR5aJg5dxJCuET5FS-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"javascript\", :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-quoted-string, :opening-paren \"\\\"\", :closing-paren (\"\\\"\"), :page-size 80, :hash \"5dsc8hKzdYc787YrnnWStEqLBFykdE\"}, :nextjournal/opts {:id \"dlai.lab1/anon-expr-5drVmYhMUkDbQVR5aJg5dxJCuET5FS-result\"}}, :nextjournal/blob-id \"5dsSQYiHBCjcaQmGX3pSHfw7scL6ba\"}, :nextjournal/opts {:id \"dlai.lab1/anon-expr-5drVmYhMUkDbQVR5aJg5dxJCuET5FS-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5du2R1U98sECF33bUCLw8ZBJ1dGaPc\"} [:p [:<> \"... oh damn, this model still needs some tuning 😭 \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:br], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:em [:<> \"BUT\"]] [:<> \", we are at the point where we can actually interact with an actual LLM running on our own machine. 🎉\"]] [:p [:<> \"Note that at this point our interaction with the model is pure \\\"completion\\\", we give it a text snippet and it will react with some probable next words, limited to 50 new tokens (see config above).\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:br], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"What we want to do though is to try and get it to do summarization for us.\"]] [\"h2\" {:id \"summarization\"} [:<> \"🗜️ Summarization\"]] [:p [:<> \"The Jupyter notebook has a lot of copy-paste going on, which I'd like to avoid here, so we'll be defining some helpers here.\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"First, some getters to work with our dataset. As we'll be using this one dataset only, this function is specific and refers to a global 🙀 - there goes our purity in favor of practicality\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5du2R1U98sECF33bUCLw8ZBJ1dGaPc\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(defn test-feature [dataset item-type nr]\\n  (get-in-items dataset [\\\"test\\\" nr item-type]))\", :nextjournal/opts {:loc {:line 162, :end-line 164, :column 1, :end-column 48}, :id \"dlai.lab1/test-feature-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5ds7Vqpv1xPtueepTseNjDnqoQ15dP\"} [:p [:<> \"... and specific to our dataset\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5ds7Vqpv1xPtueepTseNjDnqoQ15dP\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(def test-dialogue (partial test-feature dataset \\\"dialogue\\\"))\", :nextjournal/opts {:loc {:line 167, :end-line 168, :column 1, :end-column 62}, :id \"dlai.lab1/test-dialogue-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value \"(def test-summary (partial test-feature dataset \\\"summary\\\"))\", :nextjournal/opts {:loc {:line 169, :end-line 170, :column 1, :end-column 60}, :id \"dlai.lab1/test-summary-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5dsGbjK8Bk8vr41t1ZtKJptE5Kxds8\"} [:p [:<> \"This way we have a conscise way of getting at pieces of data we care about:\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5dsGbjK8Bk8vr41t1ZtKJptE5Kxds8\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(test-dialogue 42)\", :nextjournal/opts {:loc {:line 173, :end-line 174, :column 1, :end-column 19}, :id \"dlai.lab1/anon-expr-5dtYPhZ1hqABBXGuBBGp9YU2rQByUx-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value [:pre.font-sans.text-xs.drop-shadow-lg.p-6.rounded {:style {:white-space \"pre-wrap\"}} \"#Person1#: I don't know how to adjust my life. Would you give me a piece of advice?\\n#Person2#: You look a bit pale, don't you?\\n#Person1#: Yes, I can't sleep well every night.\\n#Person2#: You should get plenty of sleep.\\n#Person1#: I drink a lot of wine.\\n#Person2#: If I were you, I wouldn't drink too much.\\n#Person1#: I often feel so tired.\\n#Person2#: You better do some exercise every morning.\\n#Person1#: I sometimes find the shadow of death in front of me.\\n#Person2#: Why do you worry about your future? You're very young, and you'll make great contribution to the world. I hope you take my advice.\"], :nextjournal/visibility {:code :show, :result :show}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}, :nextjournal/opts {:id \"dlai.lab1/anon-expr-5dtYPhZ1hqABBXGuBBGp9YU2rQByUx-result\"}}, :nextjournal/blob-id \"5dsHij7EQGpyPaayFMRHRTVaRoffei\"}, :nextjournal/visibility {:code :show, :result :show}, :nextjournal/opts {:id \"dlai.lab1/anon-expr-5dtYPhZ1hqABBXGuBBGp9YU2rQByUx-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(test-summary 42)\", :nextjournal/opts {:loc {:line 176, :end-line 177, :column 1, :end-column 18}, :id \"dlai.lab1/anon-expr-5dtTf5Dsv3jTYNzFdXXeu6qg3xNjBF-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value [:pre.font-sans.text-xs.drop-shadow-lg.p-6.rounded {:style {:white-space \"pre-wrap\"}} \"#Person1# wants to adjust #Person1#'s life and #Person2# suggests #Person1# be positive and stay healthy.\"], :nextjournal/visibility {:code :show, :result :show}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}, :nextjournal/opts {:id \"dlai.lab1/anon-expr-5dtTf5Dsv3jTYNzFdXXeu6qg3xNjBF-result\"}}, :nextjournal/blob-id \"5dtCbhHK21iib56yt4eSsWeGuY8dzB\"}, :nextjournal/visibility {:code :show, :result :show}, :nextjournal/opts {:id \"dlai.lab1/anon-expr-5dtTf5Dsv3jTYNzFdXXeu6qg3xNjBF-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5dtLg7oknydJLB5nS5UqMn5L6UWHzP\"} [\"h3\" {:id \"prompt-engineering\"} [:<> \"👩‍🔧 Prompt engineering\"]] [:p [:<> \"Our whole attempt of getting the LLM do summarization for us is achieved via prompt engineering - which is fancy for \\\"Try to state what you need in a way that drives the model's behavior towards your needs\\\". \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:br], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"We'll first try \"] [:em [:<> \"zero shot\"]] [:<> \" , meaning that we don't give examples in our prompot, just try to phrase the prompt well. Here's a naive helper for this:\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5dtLg7oknydJLB5nS5UqMn5L6UWHzP\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(defn zero-shot-summarization-prompt-1 [s]\\n  (str \\\"Summarize the following text: \\\\n\\\"\\n       \\\"\\\\n\\\" s \\\"\\\\n\\\"\\n       \\\"\\\\nSummary:\\\\n\\\"))\", :nextjournal/opts {:loc {:line 183, :end-line 187, :column 1, :end-column 24}, :id \"dlai.lab1/zero-shot-summarization-prompt-1-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5dqw7WETiFGpKw3KNpbJLxmqoSoTU9\"} [:p [:<> \"Let's use this. First we'll get a dialogue from our dataset, and make a prompt out of it to see what the prompt looks like:\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5dqw7WETiFGpKw3KNpbJLxmqoSoTU9\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(->> (test-dialogue 33)\\n     (zero-shot-summarization-prompt-1))\", :nextjournal/opts {:loc {:line 191, :end-line 193, :column 1, :end-column 41}, :id \"dlai.lab1/anon-expr-5dtLh34n6NSaEbCuZdZm1sABf691jp-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value [:pre.font-sans.text-xs.drop-shadow-lg.p-6.rounded {:style {:white-space \"pre-wrap\"}} \"Summarize the following text: \\n\\n#Person1#: Welcome to my birthday party, I am so happy you can come.\\n#Person2#: Thanks for inviting me. Here is the gift for you. Happy birthday, Francis! Many more happy and healthy years for you!\\n#Person1#: Thank you, shall I open it now?\\n#Person2#: Yes, please do.\\n#Person1#: Wow, a remote car model and my favorite brand. I really like it. That is so nice of you.\\n#Person2#: Yeah, I was really struggling whether I should give you this nice little car. It was the last one they had and I really like it so much myself.\\n#Person1#: Typical you, always wanting to keep the best things for yourself. The more I appreciate the gift now.\\n\\nSummary:\\n\"], :nextjournal/visibility {:code :show, :result :show}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}, :nextjournal/opts {:id \"dlai.lab1/anon-expr-5dtLh34n6NSaEbCuZdZm1sABf691jp-result\"}}, :nextjournal/blob-id \"5drdrZY7QiEssVJeHHe9ztZxjnp4ep\"}, :nextjournal/visibility {:code :show, :result :show}, :nextjournal/opts {:id \"dlai.lab1/anon-expr-5dtLh34n6NSaEbCuZdZm1sABf691jp-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5dsswDpN9MZ8rEYP5baYJibszrnLTo\"} [:p [:<> \"And push this through our model to get a response\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5dsswDpN9MZ8rEYP5baYJibszrnLTo\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(->> (test-dialogue 33)\\n     (zero-shot-summarization-prompt-1)\\n     (generate-response model tokenizer))\", :nextjournal/opts {:loc {:line 196, :end-line 199, :column 1, :end-column 42}, :id \"dlai.lab1/anon-expr-5dsShMRVpPG5Sfb6QHME8RLnvhUifE-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value [:pre.font-sans.text-xs.drop-shadow-lg.p-6.rounded {:style {:white-space \"pre-wrap\"}} \"Francis's birthday party is coming up.\"], :nextjournal/visibility {:code :show, :result :show}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}, :nextjournal/opts {:id \"dlai.lab1/anon-expr-5dsShMRVpPG5Sfb6QHME8RLnvhUifE-result\"}}, :nextjournal/blob-id \"5dtVBg1pLAPcZMMGMmEb36SgG2QenN\"}, :nextjournal/visibility {:code :show, :result :show}, :nextjournal/opts {:id \"dlai.lab1/anon-expr-5dsShMRVpPG5Sfb6QHME8RLnvhUifE-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5dsTYM2DkjevkjGjwhG7hJPGjnrbZG\"} [:p [:<> \"Well, it's a summary, sure... not so good though\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"Let's see what the humans told us\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5dsTYM2DkjevkjGjwhG7hJPGjnrbZG\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(test-summary 33)\", :nextjournal/opts {:loc {:line 203, :end-line 204, :column 1, :end-column 18}, :id \"dlai.lab1/anon-expr-5dtxNvA93fDgSSZsEkuoSz242hHkuz-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value [:pre.font-sans.text-xs.drop-shadow-lg.p-6.rounded {:style {:white-space \"pre-wrap\"}} \"#Person2# comes to the birthday party of Francis and sends him a remote car model.\"], :nextjournal/visibility {:code :show, :result :show}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}, :nextjournal/opts {:id \"dlai.lab1/anon-expr-5dtxNvA93fDgSSZsEkuoSz242hHkuz-result\"}}, :nextjournal/blob-id \"5dr6bPDuQVdSEkp3siHEZAUV6nXGyt\"}, :nextjournal/visibility {:code :show, :result :show}, :nextjournal/opts {:id \"dlai.lab1/anon-expr-5dtxNvA93fDgSSZsEkuoSz242hHkuz-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5du22gu53D47KcHLYzy21Q7iTkFAbV\"} [:p [:<> \"What the lab does is to try and improve our response\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"Next we will try another zero-shot prompt, one that is recommended by Google for this model\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5du22gu53D47KcHLYzy21Q7iTkFAbV\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(defn zero-shot-summarization-prompt-2 [s]\\n  (str \\\"Dialogue:\\\\n\\\"\\n       \\\"\\\\n\\\" s \\\"\\\\n\\\"\\n       \\\"\\\\nWhat was going on in that conversation?\\\\n\\\"))\", :nextjournal/opts {:loc {:line 209, :end-line 213, :column 1, :end-column 55}, :id \"dlai.lab1/zero-shot-summarization-prompt-2-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5dtjYHuPd4cELCwbE4rujmFsAYAD8v\"} [:p [:<> \"And, I'd like a better way of comparing our summaries.\"]] [\"h3\" {:id \"comparing-results\"} [:<> \"⚖️ Comparing results\"]] [:p [:<> \"We'll build a function that will take the number of the test dialog that we want to summarize, and a keyed map of prompt-engineering functions\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"It will build up the prompts, run the model and collect the responses for us. Let's get to it!\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5dtjYHuPd4cELCwbE4rujmFsAYAD8v\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(defn compare-pengs [nr peng-fns-m]\\n  (hash-map\\n   :test-dialogue-number nr\\n   :dialogue (test-dialogue nr)\\n   :human-summary (test-summary nr)\\n   :model-responses (into {}\\n                          (for [[peng-name peng-fn] peng-fns-m]\\n                            {peng-name (generate-response model tokenizer (peng-fn (test-dialogue nr)))}))))\", :nextjournal/opts {:loc {:line 220, :end-line 228, :column 1, :end-column 109}, :id \"dlai.lab1/compare-pengs-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5dtigyS3AJ3zkcVerNhBdt6ths916v\"} [:p [:<> \"Now, let's compare our two prompts\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5dtigyS3AJ3zkcVerNhBdt6ths916v\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(def zero-shot-comparison\\n  (compare-pengs\\n   33\\n   {\\\"zero-shot-1\\\" zero-shot-summarization-prompt-1\\n    \\\"zero-shot-2\\\" zero-shot-summarization-prompt-2}))\", :nextjournal/opts {:loc {:line 231, :end-line 235, :column 1, :end-column 54}, :id \"dlai.lab1/zero-shot-comparison-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value [{:path [0], :nextjournal/value [{:path [0 0], :nextjournal/value :dialogue, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dty7b5oeWwc4BNN5fnBZPTMCqbFBY\"}} {:path [0 1], :nextjournal/value [\"#Person1#: Welcome to my birthday party, I am so happy you can come.\\n#Person2#: \" {:nextjournal/value {:n 80, :path [0 1], :total 635, :offset 80, :replace-path [0 1 80]}, :nextjournal/viewer {:name nextjournal.clerk.viewer/elision-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-elision, :hash \"5drduatKq2QJCDhSX1Pu45i4whSPHk\"}}], :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-quoted-string, :opening-paren \"\\\"\", :closing-paren (\"\\\"\"), :page-size 80, :hash \"5dsc8hKzdYc787YrnnWStEqLBFykdE\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #viewer-fn (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose \" \")) xs)), :page-size 2, :hash \"5drRJ7ZeVmFhX1wZfqh3qXwXNwzamW\"}} {:path [1], :nextjournal/value [{:path [1 0], :nextjournal/value :human-summary, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dty7b5oeWwc4BNN5fnBZPTMCqbFBY\"}} {:path [1 1], :nextjournal/value [\"#Person2# comes to the birthday party of Francis and sends him a remote car mode\" {:nextjournal/value {:n 80, :path [1 1], :total 82, :offset 80, :replace-path [1 1 80]}, :nextjournal/viewer {:name nextjournal.clerk.viewer/elision-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-elision, :hash \"5drduatKq2QJCDhSX1Pu45i4whSPHk\"}}], :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-quoted-string, :opening-paren \"\\\"\", :closing-paren (\"\\\"\"), :page-size 80, :hash \"5dsc8hKzdYc787YrnnWStEqLBFykdE\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #viewer-fn (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose \" \")) xs)), :page-size 2, :hash \"5drRJ7ZeVmFhX1wZfqh3qXwXNwzamW\"}} {:path [2], :nextjournal/value [{:path [2 0], :nextjournal/value :model-responses, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dty7b5oeWwc4BNN5fnBZPTMCqbFBY\"}} {:path [2 1], :nextjournal/value [{:path [2 1 0], :nextjournal/value [{:path [2 1 0 0], :nextjournal/value \"zero-shot-1\", :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-quoted-string, :opening-paren \"\\\"\", :closing-paren (\"\\\"\"), :page-size 80, :hash \"5dsc8hKzdYc787YrnnWStEqLBFykdE\"}} {:path [2 1 0 1], :nextjournal/value \"Francis's birthday party is coming up.\", :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-quoted-string, :opening-paren \"\\\"\", :closing-paren (\"\\\"\"), :page-size 80, :hash \"5dsc8hKzdYc787YrnnWStEqLBFykdE\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #viewer-fn (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose \" \")) xs)), :page-size 2, :hash \"5drRJ7ZeVmFhX1wZfqh3qXwXNwzamW\"}} {:path [2 1 1], :nextjournal/value [{:path [2 1 1 0], :nextjournal/value \"zero-shot-2\", :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-quoted-string, :opening-paren \"\\\"\", :closing-paren (\"\\\"\"), :page-size 80, :hash \"5dsc8hKzdYc787YrnnWStEqLBFykdE\"}} {:path [2 1 1 1], :nextjournal/value \"Francis is celebrating his birthday.\", :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-quoted-string, :opening-paren \"\\\"\", :closing-paren (\"\\\"\" \"}\"), :page-size 80, :hash \"5dsc8hKzdYc787YrnnWStEqLBFykdE\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #viewer-fn (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose \" \")) xs)), :page-size 2, :hash \"5drRJ7ZeVmFhX1wZfqh3qXwXNwzamW\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-map, :opening-paren \"{\", :page-size 10, :hash \"5drc3ac5ux7kS4h2vozdxwsrKDqSmn\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #viewer-fn (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose \" \")) xs)), :page-size 2, :hash \"5drRJ7ZeVmFhX1wZfqh3qXwXNwzamW\"}} {:path [3], :nextjournal/value [{:path [3 0], :nextjournal/value :test-dialogue-number, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dty7b5oeWwc4BNN5fnBZPTMCqbFBY\"}} {:path [3 1], :nextjournal/value 33, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #viewer-fn (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose \" \")) xs)), :page-size 2, :hash \"5drRJ7ZeVmFhX1wZfqh3qXwXNwzamW\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-map, :opening-paren \"{\", :closing-paren (\"}\"), :page-size 10, :hash \"5drc3ac5ux7kS4h2vozdxwsrKDqSmn\"}, :nextjournal/opts {:id \"dlai.lab1/zero-shot-comparison-result\"}}, :nextjournal/blob-id \"5du46BwzD3MBTVLWWpFPkQAiC74Bz4\"}, :nextjournal/opts {:id \"dlai.lab1/zero-shot-comparison-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5dsbGaY8szFLjdqvHn5Gct72kZFago\"} [:p [:<> \"We need a better way to see this, let's dig and create a table view (expand if interested)\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5dsbGaY8szFLjdqvHn5Gct72kZFago\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(def results-viewer\\n  {:transform-fn\\n   (clerk/update-val\\n    #(clerk/html\\n      [:div.font-sans.font-normal\\n       [:table.table-auto.rounded-sm\\n        [:tr\\n         [:th.border.px-4 \\\"Dialogue #\\\" (:test-dialogue-number %)]\\n         [:th.border.px-4.font-normal\\n          [:details [:summary \\\"Expand\\\"] [:pre {:style {:white-space \\\"pre-wrap\\\"}} (:dialogue %)] ] ]]\\n        [:tr\\n         [:th.border.px-4 \\\"Human\\\"]\\n         [:th.border.px-4.font-normal (:human-summary %)]]\\n        (for [[mname mresp]\\n              (:model-responses %)]\\n          [:tr\\n           [:th.border.px-4 mname]\\n           [:th.border.px-4.font-normal mresp]])]\\n       ]))})\", :nextjournal/opts {:loc {:line 240, :end-line 259, :column 1, :end-column 13}, :id \"dlai.lab1/results-viewer-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/folded-code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-folded-code-block, :hash \"5dt3F3pXDCJHWEKwRWd1FTwBTC7bQ1\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5dtbjawhb1m7KyhRSjHp1aYkF7UbT3\"} [:p [:<> \"Let's use this\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5dtbjawhb1m7KyhRSjHp1aYkF7UbT3\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"zero-shot-comparison\", :nextjournal/opts {:loc {:line 262, :end-line 263, :column 1, :end-column 21}, :id \"dlai.lab1/anon-expr-5duCJVm13coGRBkbTtSZCtDd46eZvy-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value [:div.font-sans.font-normal [:table.table-auto.rounded-sm [:tr [:th.border.px-4 \"Dialogue #\" 33] [:th.border.px-4.font-normal [:details [:summary \"Expand\"] [:pre {:style {:white-space \"pre-wrap\"}} \"#Person1#: Welcome to my birthday party, I am so happy you can come.\\n#Person2#: Thanks for inviting me. Here is the gift for you. Happy birthday, Francis! Many more happy and healthy years for you!\\n#Person1#: Thank you, shall I open it now?\\n#Person2#: Yes, please do.\\n#Person1#: Wow, a remote car model and my favorite brand. I really like it. That is so nice of you.\\n#Person2#: Yeah, I was really struggling whether I should give you this nice little car. It was the last one they had and I really like it so much myself.\\n#Person1#: Typical you, always wanting to keep the best things for yourself. The more I appreciate the gift now.\"]]]] [:tr [:th.border.px-4 \"Human\"] [:th.border.px-4.font-normal \"#Person2# comes to the birthday party of Francis and sends him a remote car model.\"]] ([:tr [:th.border.px-4 \"zero-shot-1\"] [:th.border.px-4.font-normal \"Francis's birthday party is coming up.\"]] [:tr [:th.border.px-4 \"zero-shot-2\"] [:th.border.px-4.font-normal \"Francis is celebrating his birthday.\"]])]], :nextjournal/visibility {:code :show, :result :show}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}, :nextjournal/opts {:id \"dlai.lab1/anon-expr-5duCJVm13coGRBkbTtSZCtDd46eZvy-result\"}}, :nextjournal/blob-id \"5dsUJQtNSRdhjTwpp1pqfPMdRfAS8E\"}, :nextjournal/visibility {:code :show, :result :show}, :nextjournal/opts {:id \"dlai.lab1/anon-expr-5duCJVm13coGRBkbTtSZCtDd46eZvy-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5driaEWisrk97o9kGs9iDPnbWJpJTT\"} [:p [:<> \"compare a few examples using the above two zero-shot prompts\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5driaEWisrk97o9kGs9iDPnbWJpJTT\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(mapv #(v/with-viewer results-viewer (compare-pengs % {\\\"zero-shot-1\\\" zero-shot-summarization-prompt-1\\n                                                       \\\"zero-shot-2\\\" zero-shot-summarization-prompt-2}))\\n      (take 5 (shuffle (range 1500))))\", :nextjournal/opts {:loc {:line 266, :end-line 268, :column 1, :end-column 39}, :id \"dlai.lab1/anon-expr-5drptvyyb2JdNBsy23Cq7koZNhC9rk-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value [{:path [0], :nextjournal/value [:div.font-sans.font-normal [:table.table-auto.rounded-sm [:tr [:th.border.px-4 \"Dialogue #\" 763] [:th.border.px-4.font-normal [:details [:summary \"Expand\"] [:pre {:style {:white-space \"pre-wrap\"}} \"#Person1#: Did you need help with something?\\n#Person2#: I don't know where to get my ballot.\\n#Person1#: I can help you with that.\\n#Person2#: How can you help me?\\n#Person1#: I work here.\\n#Person2#: That's great.\\n#Person1#: May I see your ID?\\n#Person2#: Here it is.\\n#Person1#: All right, here is your ballot card.\\n#Person2#: What do I do now?\\n#Person1#: Go to a voting booth and vote.\\n#Person2#: All right. Thanks for your help.\"]]]] [:tr [:th.border.px-4 \"Human\"] [:th.border.px-4.font-normal \"#Person1# helps #Person2# to get a ballot and go vote.\"]] ([:tr [:th.border.px-4 \"zero-shot-1\"] [:th.border.px-4.font-normal \"#Person1#: I'm here to help you. #Person2#: Thanks.\"]] [:tr [:th.border.px-4 \"zero-shot-2\"] [:th.border.px-4.font-normal \"Person1 is helping Person2 with getting his ballot.\"]])]], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}} {:path [1], :nextjournal/value [:div.font-sans.font-normal [:table.table-auto.rounded-sm [:tr [:th.border.px-4 \"Dialogue #\" 1151] [:th.border.px-4.font-normal [:details [:summary \"Expand\"] [:pre {:style {:white-space \"pre-wrap\"}} \"#Person1#: Hi, Bob, guess what? I'm going to visit Quebec next summer. I'm invited to go to a friend's wedding, but while I'm there, I'd also like to do some sightseeing.\\n#Person2#: That's nice, Sherry. But do you mean the province of Quebec or Quebec City?\\n#Person1#: I mean the province. My friend's wedding is in Montreal, so I'm going there first. I'll stay for 5 days. Is Montreal the capital city of the province?\\n#Person2#: Well, many people think so because it's the biggest city, but it's not the capital. Quebec City is, but Montreal is great. The Santa Lawrence River runs right through the middle of the city. It's beautiful in summer.\\n#Person1#: Wow, and do you think I can get by in English? My French is okay, but not that good. I know most people there speak French, but can I also use English?\\n#Person2#: Well, people speak both French and English there, but you'll hear French most of the time and all the street signs are in French. In fact, Montreal is the third largest French-speaking city in the world. So you'd better practice your French before you go.\\n#Person1#: Good advice, what about Quebec City? I'll visit a friend from college who lives there now. What's it like?\\n#Person2#: It's a beautiful city, very old. Many old buildings have been nicely restored. Some of them were built in the 17th and 18th centuries. You'll love it there.\\n#Person1#: Fantastic. I can't wait to go.\"]]]] [:tr [:th.border.px-4 \"Human\"] [:th.border.px-4.font-normal \"Sherry will go to Montreal, Quebec next summer. Bob suggests she practice French since Montreal is the third largest French-speaking city. Sherry will also visit a friend in Quebec City.\"]] ([:tr [:th.border.px-4 \"zero-shot-1\"] [:th.border.px-4.font-normal \"The person is going to Quebec City.\"]] [:tr [:th.border.px-4 \"zero-shot-2\"] [:th.border.px-4.font-normal \"Bob is going to visit Quebec next summer. He's going to visit a friend's wedding in Montreal. He's going to visit Quebec City.\"]])]], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}} {:path [2], :nextjournal/value [:div.font-sans.font-normal [:table.table-auto.rounded-sm [:tr [:th.border.px-4 \"Dialogue #\" 466] [:th.border.px-4.font-normal [:details [:summary \"Expand\"] [:pre {:style {:white-space \"pre-wrap\"}} \"#Person1#: Good morning, thanks for coming. Shall we begin? Why do you want to be a music teacher?\\n#Person2#: Because I've been always loving music since I was young. And I hope I could have a job that suits my interest.\\n#Person1#: Do you have a degree in related fields?\\n#Person2#: Yes, I have a bachelor and a master degree in music and art.\\n#Person1#: Oh, that's very impressive. What kind of music do you like listening to?\\n#Person2#: I like many kinds of music. Sometimes I listen to the music that has fast beat and is lively, like dance music. You know, I go to a disco almost every week. Sometimes it's too loud though. And I love classical music the most. I find it very relaxing. I often listen to Mozart or Bach in the evening after a hard day at work.\\n#Person1#: How do you know about classical music?\\n#Person1#: Actually, I specialized in classical music for my master study. Classical music is supposed to be good for you brain. Researches suggest that it makes your brain more active. Students who listen to classical music while studying perform better. That's true. There's clear evidence that people who listen to lively music are lively people. Music can influence a person's feeling and character.\\n#Person2#: Good, I am pretty satisfied with your background. Do you think students should listen to more classical music than others and why?\\n#Person1#: Yes. Sometimes students can be stressful. Listening to classical music is helpful in reducing stress. That's why I listen to it in the evenings. I usually play it as background music while I'm cooking or doing other housework.\\n#Person2#: Okay, I think I've known enough of you. The interview is over.\\n#Person1#: Thank you for your time.\\n#Person2#: Oh, by the way. I think I may want to listen to some classical music. Do you have any suggestions?\\n#Person1#: You can find plenty of recording on the internet. You can search and listen to different classical music and see which interests you the most. You can also buy them very cheaply online if you like them.\\n#Person2#: That's a good idea. I'll try it.\"]]]] [:tr [:th.border.px-4 \"Human\"] [:th.border.px-4.font-normal \"#Person1# interviews #Person2# for a music teacher position. #Person1# is very satisfied with #Person2#'s educational background in music and #Person2#'s understanding of classical music. After the interview, #Person2# suggests #Person1# can develop interests in classic music by listening to different classic music online.\"]] ([:tr [:th.border.px-4 \"zero-shot-1\"] [:th.border.px-4.font-normal \"Interviewer: Person1: I'm interviewing for a job as a music teacher.\"]] [:tr [:th.border.px-4 \"zero-shot-2\"] [:th.border.px-4.font-normal \"The interviewer is interviewing for a job as a music teacher.\"]])]], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}} {:path [3], :nextjournal/value [:div.font-sans.font-normal [:table.table-auto.rounded-sm [:tr [:th.border.px-4 \"Dialogue #\" 843] [:th.border.px-4.font-normal [:details [:summary \"Expand\"] [:pre {:style {:white-space \"pre-wrap\"}} \"#Person1#: OK, Lucy. It's your turn. Are you ready?\\n#Person2#: I really would rather just listen. Isn't there anyone else who wants to sing?\\n#Person1#: Come on! In the two hours we've been here, you haven't sung even one song!\\n#Person2#: I know, but. . . Hey, Stanley's here! I've been wanting to hear him sing all night.\\n#Person1#: Well, you asked for it. Why don't you put on an Elvis'song for him.\\n#Person2#: I'll put the song at the front of the list.\"]]]] [:tr [:th.border.px-4 \"Human\"] [:th.border.px-4.font-normal \"#Person1# asks Lucy to sing but Lucy is unwilling to do so.\"]] ([:tr [:th.border.px-4 \"zero-shot-1\"] [:th.border.px-4.font-normal \"Person1 wants to sing for Person2 because she hasn't sung in two hours.\"]] [:tr [:th.border.px-4 \"zero-shot-2\"] [:th.border.px-4.font-normal \"Person1 wants to sing for Stanley.\"]])]], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}} {:path [4], :nextjournal/value [:div.font-sans.font-normal [:table.table-auto.rounded-sm [:tr [:th.border.px-4 \"Dialogue #\" 536] [:th.border.px-4.font-normal [:details [:summary \"Expand\"] [:pre {:style {:white-space \"pre-wrap\"}} \"#Person1#: Can I help you?\\n#Person2#: Yes, is there any vacant room for tomorrow?\\n#Person1#: I am sorry. We are full up for tomorrow.\\n#Person2#: Well, is there any other hotel nearby?\\n#Person1#: Yes, the Sunset Hotel is three blocks away. Maybe you can ask them.\\n#Person2#: Thank you.\"]]]] [:tr [:th.border.px-4 \"Human\"] [:th.border.px-4.font-normal \"#Person1# recommends #Person2# going to the Sunset Hotel to find vacant rooms as #Person1#'s hotel is full.\"]] ([:tr [:th.border.px-4 \"zero-shot-1\"] [:th.border.px-4.font-normal \"The Sunset Hotel is three blocks away.\"]] [:tr [:th.border.px-4 \"zero-shot-2\"] [:th.border.px-4.font-normal \"The Sunset Hotel is three blocks away from Person1 and the other hotel.\"]])]], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}], :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-coll, :opening-paren \"[\", :closing-paren (\"]\"), :page-size 20, :hash \"5dsKpRYUuGnwVK3BPfAoiJqkhVbPzH\"}, :nextjournal/opts {:id \"dlai.lab1/anon-expr-5drptvyyb2JdNBsy23Cq7koZNhC9rk-result\"}}, :nextjournal/blob-id \"5dr55x9CgFYbyXppm36YVx94PQWdCy\"}, :nextjournal/opts {:id \"dlai.lab1/anon-expr-5drptvyyb2JdNBsy23Cq7koZNhC9rk-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5dt1FbRoqTbJBgZT1SRAgBu4Lehw3b\"} [\"h3\" {:id \"one-shot-and-few-shot\"} [:<> \"🔫 One-shot and few-shot\"]] [:p [:<> \"Now we'll move on to try another prompt-engineering technique, sometimes called in-context learning. This is one-shot or few-shot inference.\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:br], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"The idea here is to include some sample question-response pairs in our prompt itself, giving the model some guidance (by understanding the internal structure of the prompt itself) on what we expect it to do.\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"In the official Jupyter notebook the given samples are listed out, but I'd like to do some randomization here\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:br], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"We have 1500 test items which we will split into two groups: one small group (let's do 10) we'll use as examples in our prompts; others we'll use as actual tasks for summarization\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5dt1FbRoqTbJBgZT1SRAgBu4Lehw3b\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(def task-indexes (take 10 (shuffle (range 1500))))\", :nextjournal/opts {:loc {:line 277, :end-line 277, :column 1, :end-column 52}, :id \"dlai.lab1/task-indexes-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value [{:path [0], :nextjournal/value 1034, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:path [1], :nextjournal/value 578, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:path [2], :nextjournal/value 1095, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:path [3], :nextjournal/value 1262, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:path [4], :nextjournal/value 360, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:path [5], :nextjournal/value 454, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:path [6], :nextjournal/value 1245, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:path [7], :nextjournal/value 371, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:path [8], :nextjournal/value 1282, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:path [9], :nextjournal/value 485, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}}], :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-coll, :opening-paren \"(\", :closing-paren (\")\"), :page-size 20, :hash \"5drCaZg3GZ5pGiaCNpMq9dEBvceFbm\"}, :nextjournal/opts {:id \"dlai.lab1/task-indexes-result\"}}, :nextjournal/blob-id \"5dqpD5Ew9Wa8wdc2HChVvDUrWzx1Kq\"}, :nextjournal/opts {:id \"dlai.lab1/task-indexes-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def potential-example-indices (clojure.set/difference (set (range 1500)) task-indexes))\", :nextjournal/opts {:loc {:line 278, :end-line 278, :column 1, :end-column 89}, :id \"dlai.lab1/potential-example-indices-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value [{:path [0], :nextjournal/value 0, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:path [1], :nextjournal/value 1, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:path [2], :nextjournal/value 2, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:path [3], :nextjournal/value 3, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:path [4], :nextjournal/value 4, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:path [5], :nextjournal/value 5, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:path [6], :nextjournal/value 6, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:path [7], :nextjournal/value 7, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:path [8], :nextjournal/value 8, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:path [9], :nextjournal/value 9, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:path [10], :nextjournal/value 10, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:path [11], :nextjournal/value 11, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:path [12], :nextjournal/value 12, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:path [13], :nextjournal/value 13, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:path [14], :nextjournal/value 14, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:path [15], :nextjournal/value 15, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:path [16], :nextjournal/value 16, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:path [17], :nextjournal/value 17, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:path [18], :nextjournal/value 18, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:path [19], :nextjournal/value 19, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}} {:nextjournal/value {:n 20, :path [], :total 1490, :offset 20}, :nextjournal/viewer {:name nextjournal.clerk.viewer/elision-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-elision, :hash \"5drduatKq2QJCDhSX1Pu45i4whSPHk\"}}], :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-coll, :opening-paren \"#{\", :closing-paren (\"}\"), :page-size 20, :hash \"5dsqjWFHxfJMj6muMSLAWx8pdnsF3M\"}, :nextjournal/opts {:id \"dlai.lab1/potential-example-indices-result\"}}, :nextjournal/blob-id \"5duKXwDgB63pamgx8qFX4kwMzS5JHL\"}, :nextjournal/opts {:id \"dlai.lab1/potential-example-indices-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5dt9cPEXUoPE1wqhEi9T22ffQ5oxn6\"} [:p [:<> \"Now we'll implement a few-shot prompt engineering function with some helpers.\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:br], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"This one will get n examples as maps from our dataset, limited to the subset that we want to use as examples (not tasks)\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5dt9cPEXUoPE1wqhEi9T22ffQ5oxn6\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(defn get-examples \\\"Gets n examples from dataset, using potential indexes\\\"\\n  [potential-examples n]\\n  (let [get-random-n-elements (fn [s n] (take n (shuffle s)))\\n        example-indices  (get-random-n-elements potential-examples n)]\\n    (mapv\\n     #(hash-map\\n       :dialogue (test-dialogue %)\\n       :human-summary (test-summary %))\\n     example-indices)))\", :nextjournal/opts {:loc {:line 283, :end-line 292, :column 1, :end-column 24}, :id \"dlai.lab1/get-examples-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5drVEqXV14gsxMoAhr5ZRwEkZCj2HB\"} [:p [:<> \"This one will format one of the examples as a string snippet to include in our prompt\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5drVEqXV14gsxMoAhr5ZRwEkZCj2HB\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(defn format-example [e]\\n  (str \\\"Dialogue: \\\\n\\\"\\n       (:dialogue e)\\n       \\\"\\\\n\\\\n\\\"\\n       \\\"What was going on in that conversation?\\\\n\\\\n\\\"\\n       (:human-summary e)\\n       \\\"\\\\n\\\\n\\\"))\", :nextjournal/opts {:loc {:line 295, :end-line 302, :column 1, :end-column 16}, :id \"dlai.lab1/format-example-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5drfgUfEW1NowWzprHxBc82W2ArCtJ\"} [:p [:<> \"This will use the previous two to build a prompt snippet of n examples\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5drfgUfEW1NowWzprHxBc82W2ArCtJ\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(defn examples-prompt [n potential-example-indices]\\n  (apply str (map format-example (get-examples potential-example-indices n))))\", :nextjournal/opts {:loc {:line 305, :end-line 307, :column 1, :end-column 79}, :id \"dlai.lab1/examples-prompt-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5dtfFAF3rXJdKoN76wRLTndzufzuax\"} [:p [:<> \"And this one will append our actual task (non-example) section of our prompt\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5dtfFAF3rXJdKoN76wRLTndzufzuax\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(defn prompt-with-n-examples [n potential-example-indices dialogue]\\n  (str\\n   (examples-prompt n potential-example-indices)\\n   \\\"Dialogue: \\\\n\\\"\\n   dialogue\\n   \\\"\\\\n\\\\n\\\"\\n   \\\"What was going on in that conversation?\\\\n\\\\n\\\"))\", :nextjournal/opts {:loc {:line 310, :end-line 317, :column 1, :end-column 51}, :id \"dlai.lab1/prompt-with-n-examples-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5dtG8bVpyfZsn6vwuVEAf2PZ4nUbyP\"} [:p [:<> \"Now let's build a prompt with 2 shots\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5dtG8bVpyfZsn6vwuVEAf2PZ4nUbyP\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(prompt-with-n-examples 2 potential-example-indices (test-dialogue (first task-indexes)))\", :nextjournal/opts {:loc {:line 320, :end-line 321, :column 1, :end-column 90}, :id \"dlai.lab1/anon-expr-5duKAtziF1dx2fsyDyzfUCJfqQWK4u-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value [:pre.font-sans.text-xs.drop-shadow-lg.p-6.rounded {:style {:white-space \"pre-wrap\"}} \"Dialogue: \\n#Person1#: Listen to this. Mary got married.\\n#Person2#: Is she really? I can't believe it!\\n#Person1#: Yes. Yesterday.\\n#Person2#: Good gracious. That's incredible!\\n#Person1#: She married Jerrod.\\n#Person2#: You're kidding.\\n#Person1#: She's going to live in Paris.\\n#Person2#: Really? I'm surprised.\\n\\nWhat was going on in that conversation?\\n\\n#Person2# is surprised to hear from #Person1# that Mary got married.\\n\\nDialogue: \\n#Person1#: Hello, this is Francis.\\n#Person2#: Hi, this is Monica. I was wondering when we can work on this financial report.\\n#Person1#: Today, I am busy all day long.\\n#Person2#: Shall I see you on Friday morning?\\n#Person1#: That's not good for me at all. It'll have to be another time.\\n#Person2#: We must find some time to read report.\\n#Person1#: I know. I am available from 1 PM to 4 PM on Friday afternoon.\\n#Person2#: That's all right. Then see you on Friday afternoon.\\n#Person1#: See you.\\n\\nWhat was going on in that conversation?\\n\\nFrancis and Monica manage to find time to work on a report together.\\n\\nDialogue: \\n#Person1#: There are so many environmental problems in the world today. Do you think we can really solve them all or will destroy the world?\\n#Person2#: I hope that world leaders can get together and agree on a plan for action, but I doubt it'll happen before it's too late.  \\n#Person1#: We need to solve the problem of air pollution before we destroy the atmosphere. There's lots of clean, modern technology, but companies in developed countries say it's expensive. Developing countries put more emphasis on economic development than on environmental protection.\\n#Person2#: Everyone is looking at the issue in the short term, rather than the long term. It's the same with the destruction of the rainforests. Countries and companies just want the wood. They're not thinking about the long-term damage to the forests. We should also remember that the forests are an important natural habitat for thousands of species of animal and plant life.  \\n#Person1#: In other parts of the world, especially in Africa, there is a problem with desertification. Climate change and over-farming are causing farmland to turn into desert. In means that people cannot grow enough food.  \\n#Person2#: It also means that people sometimes fight over the farmland that remains. Damaging the environment actually leads to conflict between people.  \\n#Person1#: Have you ever thought about joining an organization committed to protecting the environment? You could get involved with projects to improve the environment.  \\n#Person2#: I think I'd like to do that. I could take the things I learn here back to my country when I have finished my studies.  \\n\\nWhat was going on in that conversation?\\n\\n\"], :nextjournal/visibility {:code :show, :result :show}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}, :nextjournal/opts {:id \"dlai.lab1/anon-expr-5duKAtziF1dx2fsyDyzfUCJfqQWK4u-result\"}}, :nextjournal/blob-id \"5dr6vG4X2AWnUFhDN3wTkd85MENTbi\"}, :nextjournal/visibility {:code :show, :result :show}, :nextjournal/opts {:id \"dlai.lab1/anon-expr-5duKAtziF1dx2fsyDyzfUCJfqQWK4u-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5draS3cnYSDazsVD1QUpTd69qbC35G\"} [:p [:<> \"As expected, this is pretty long, but you can see both the examples and the actual task being included\"]] [\"h2\" {:id \"the-big-finale\"} [:<> \"🎬 The big finale\"]] [:p [:<> \"Now, let's see how this performs with 1 shots, 4 shots and against the two zero-shot prompts on our 15 tasks\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"Note, that this can be pretty slow, depending on where you run this. Be patient!\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5draS3cnYSDazsVD1QUpTd69qbC35G\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}} {:path [], :nextjournal/value \"(def big-comparison-result\\n  (mapv\\n   #(v/with-viewer results-viewer\\n      (compare-pengs\\n       %\\n       {\\\"zero-shot-1\\\" zero-shot-summarization-prompt-1\\n        \\\"zero-shot-2\\\" zero-shot-summarization-prompt-2\\n        \\\"one-shot\\\" (partial prompt-with-n-examples 1 potential-example-indices)\\n        \\\"four-shot\\\" (partial prompt-with-n-examples 1 potential-example-indices)}))\\n   task-indexes))\", :nextjournal/opts {:loc {:line 327, :end-line 336, :column 1, :end-column 18}, :id \"dlai.lab1/big-comparison-result-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value [{:path [0], :nextjournal/value [:div.font-sans.font-normal [:table.table-auto.rounded-sm [:tr [:th.border.px-4 \"Dialogue #\" 1034] [:th.border.px-4.font-normal [:details [:summary \"Expand\"] [:pre {:style {:white-space \"pre-wrap\"}} \"#Person1#: There are so many environmental problems in the world today. Do you think we can really solve them all or will destroy the world?\\n#Person2#: I hope that world leaders can get together and agree on a plan for action, but I doubt it'll happen before it's too late.  \\n#Person1#: We need to solve the problem of air pollution before we destroy the atmosphere. There's lots of clean, modern technology, but companies in developed countries say it's expensive. Developing countries put more emphasis on economic development than on environmental protection.\\n#Person2#: Everyone is looking at the issue in the short term, rather than the long term. It's the same with the destruction of the rainforests. Countries and companies just want the wood. They're not thinking about the long-term damage to the forests. We should also remember that the forests are an important natural habitat for thousands of species of animal and plant life.  \\n#Person1#: In other parts of the world, especially in Africa, there is a problem with desertification. Climate change and over-farming are causing farmland to turn into desert. In means that people cannot grow enough food.  \\n#Person2#: It also means that people sometimes fight over the farmland that remains. Damaging the environment actually leads to conflict between people.  \\n#Person1#: Have you ever thought about joining an organization committed to protecting the environment? You could get involved with projects to improve the environment.  \\n#Person2#: I think I'd like to do that. I could take the things I learn here back to my country when I have finished my studies.  \"]]]] [:tr [:th.border.px-4 \"Human\"] [:th.border.px-4.font-normal \"#Person1# and #Person2# are talking about environmental problems in the world today. They think everyone is looking at the issue in the short term and damaging the environment leads to conflict between people.\"]] ([:tr [:th.border.px-4 \"zero-shot-1\"] [:th.border.px-4.font-normal \"The world needs to be more responsible about the environment.\"]] [:tr [:th.border.px-4 \"zero-shot-2\"] [:th.border.px-4.font-normal \"The world leaders are discussing the environmental problems.\"]] [:tr [:th.border.px-4 \"one-shot\"] [:th.border.px-4.font-normal \"The world leaders are discussing the environmental problems.\"]] [:tr [:th.border.px-4 \"four-shot\"] [:th.border.px-4.font-normal \"The world leaders are discussing the environmental problems.\"]])]], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}} {:path [1], :nextjournal/value [:div.font-sans.font-normal [:table.table-auto.rounded-sm [:tr [:th.border.px-4 \"Dialogue #\" 578] [:th.border.px-4.font-normal [:details [:summary \"Expand\"] [:pre {:style {:white-space \"pre-wrap\"}} \"#Person1#: Hello Martin, how are your preparations for the coming exams?\\n#Person2#: Good, Miss Eliza. I've worked hard for it recently. I think I'm ready for the coming exams.\\n#Person1#: Excellent, so are you working at weekends now to get some pocket money?\\n#Person2#: Yes, I'm very grateful to Mister Lamb, he really helped me with my problem.\\n#Person1#: Mister Lam said that your problem was that you have no pocket money.\\n#Person2#: That's right. I couldn't go out with my friends because I didn't even have the money for the bus fee. But I'm OK now, with a part-time job.\\n#Person1#: So do you think the students welfare club really helped you?\\n#Person2#: Oh yes, I have no complaints about the club, I think it is fantastic.\\n#Person1#: Thanks for your time, Martin.\"]]]] [:tr [:th.border.px-4 \"Human\"] [:th.border.px-4.font-normal \"Martin tells Miss Eliza about his exams and his part-time job. Martin appreciates Mister Lam and the students' welfare club.\"]] ([:tr [:th.border.px-4 \"zero-shot-1\"] [:th.border.px-4.font-normal \"Martin is working at weekends to get some pocket money.\"]] [:tr [:th.border.px-4 \"zero-shot-2\"] [:th.border.px-4.font-normal \"Martin is working at weekends to get some pocket money.\"]] [:tr [:th.border.px-4 \"one-shot\"] [:th.border.px-4.font-normal \"Martin is working at weekends to get some pocket money.\"]] [:tr [:th.border.px-4 \"four-shot\"] [:th.border.px-4.font-normal \"Martin is working at weekends to get some pocket money.\"]])]], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}} {:path [2], :nextjournal/value [:div.font-sans.font-normal [:table.table-auto.rounded-sm [:tr [:th.border.px-4 \"Dialogue #\" 1095] [:th.border.px-4.font-normal [:details [:summary \"Expand\"] [:pre {:style {:white-space \"pre-wrap\"}} \"#Person1#: Have you gone bowling before?\\n#Person2#: No. Could you tell me something more about it? I want to play well.\\n#Person1#: There are 10 frames in a bowling game. Each player is allowed to bowl two balls in each frame.\\n#Person2#: You just said 10 rounds.\\n#Person1#: 'Round' and 'frame' are two different terms.\\n#Person2#: Perhaps you can tell me a little more about this.\\n#Person1#: Hey, slow down. I'll tell you more while playing.\"]]]] [:tr [:th.border.px-4 \"Human\"] [:th.border.px-4.font-normal \"#Person1# teaches #Person2# the rules and terms of bowling.\"]] ([:tr [:th.border.px-4 \"zero-shot-1\"] [:th.border.px-4.font-normal \"#Person1#: Have you ever bowled? #Person2#: No. I'm not sure. #Person1#: I'm not sure. #Person2#: I'm not sure\"]] [:tr [:th.border.px-4 \"zero-shot-2\"] [:th.border.px-4.font-normal \"The person wants to know more about the game.\"]] [:tr [:th.border.px-4 \"one-shot\"] [:th.border.px-4.font-normal \"#Person1#: I want to play well.\"]] [:tr [:th.border.px-4 \"four-shot\"] [:th.border.px-4.font-normal \"#Person1 wants to know more about the game of bowling.\"]])]], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}} {:path [3], :nextjournal/value [:div.font-sans.font-normal [:table.table-auto.rounded-sm [:tr [:th.border.px-4 \"Dialogue #\" 1262] [:th.border.px-4.font-normal [:details [:summary \"Expand\"] [:pre {:style {:white-space \"pre-wrap\"}} \"#Person1#: Hi there! I am looking for a new car. I have this old Ford Pinto that I would like to trade in.\\n#Person2#: I see. You are in luck this month because all of our models are on sale! it is a perfect time to buy a new car since it's the end of the year.\\n#Person1#: Perfect! I like this one.\\n#Person2#: That is the Ford Focus. A very light but powerful vehicle. It comes with dual side airbags, power steering and power windows, tinted windows and your choice of either automatic or manual transmission.\\n#Person1#: Sounds like a good car! How many miles to the gallon?\\n#Person2#: It is a very fuel efficient vehicle giving you about 34 miles in the city and 40 on the highway.\\n#Person1#: That is really convenient. Especially now that fuel prices are so high! What's under the hood?\\n#Person2#: A very powerful 2. 5- liter turbocharged engine, Trust me, this car is fast!\\n#Person1#: Now for the most difficult question. What is the price tag for this lovely vehicle?\\n#Person2#: Very affordable sir. You can take it out of this lot today with 0 % down payment and no interest for the first year! You can test drive it now and we can sign the papers when we get back.\\n#Person1#: Great! Let's do it!\"]]]] [:tr [:th.border.px-4 \"Human\"] [:th.border.px-4.font-normal \"#Person2# gives #Person1# a full introduction of the Ford Focus #Person1# intends to test drive it.\"]] ([:tr [:th.border.px-4 \"zero-shot-1\"] [:th.border.px-4.font-normal \"The Ford Focus is on sale at the dealership.\"]] [:tr [:th.border.px-4 \"zero-shot-2\"] [:th.border.px-4.font-normal \"The Ford Focus is on sale.\"]] [:tr [:th.border.px-4 \"one-shot\"] [:th.border.px-4.font-normal \"The Ford Focus is on sale.\"]] [:tr [:th.border.px-4 \"four-shot\"] [:th.border.px-4.font-normal \"The Ford Focus is on sale.\"]])]], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}} {:path [4], :nextjournal/value [:div.font-sans.font-normal [:table.table-auto.rounded-sm [:tr [:th.border.px-4 \"Dialogue #\" 360] [:th.border.px-4.font-normal [:details [:summary \"Expand\"] [:pre {:style {:white-space \"pre-wrap\"}} \"#Person1#: Have you given the puppies food yet?\\n#Person2#: Of course. I fed them today.\\n#Person1#: Good job! Please give them a bath later on today.\\n#Person2#: Sure, I'll give them a bath.\\n#Person1#: Thanks. But don't forget that they have a vet appointment this Saturday.\\n#Person2#: I remember. What time do they need to be there?\\n#Person1#: They need to be there at eleven in the morning.\\n#Person2#: All right. I'll make sure and remember.\"]]]] [:tr [:th.border.px-4 \"Human\"] [:th.border.px-4.font-normal \"#Person1# asks something about #Person2#'s care with puppies and reminds #Person2# of the vet appointment.\"]] ([:tr [:th.border.px-4 \"zero-shot-1\"] [:th.border.px-4.font-normal \"The puppies have a vet appointment this Saturday.\"]] [:tr [:th.border.px-4 \"zero-shot-2\"] [:th.border.px-4.font-normal \"The puppies have a vet appointment this Saturday at eleven in the morning.\"]] [:tr [:th.border.px-4 \"one-shot\"] [:th.border.px-4.font-normal \"The puppies have a vet appointment this Saturday at eleven in the morning.\"]] [:tr [:th.border.px-4 \"four-shot\"] [:th.border.px-4.font-normal \"The puppies have a vet appointment this Saturday at eleven in the morning.\"]])]], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}} {:path [5], :nextjournal/value [:div.font-sans.font-normal [:table.table-auto.rounded-sm [:tr [:th.border.px-4 \"Dialogue #\" 454] [:th.border.px-4.font-normal [:details [:summary \"Expand\"] [:pre {:style {:white-space \"pre-wrap\"}} \"#Person1#: Have you enjoyed your weekend?\\n#Person2#: Yes, it's been marvelous. It really was very kind of you to invite me. I hope it hasn't been too much trouble.\\n#Person1#: Not at all. We've really enjoyed having you. I hope you'll come and stay again next time you're in Changsha.\"]]]] [:tr [:th.border.px-4 \"Human\"] [:th.border.px-4.font-normal \"#Person1# and #Person2# has enjoyed a nice weekend together.\"]] ([:tr [:th.border.px-4 \"zero-shot-1\"] [:th.border.px-4.font-normal \"#Person1#: Have you enjoyed your weekend?\"]] [:tr [:th.border.px-4 \"zero-shot-2\"] [:th.border.px-4.font-normal \"Person1 is in Changsha for a weekend.\"]] [:tr [:th.border.px-4 \"one-shot\"] [:th.border.px-4.font-normal \"Person1 is in Changsha and invites Person2 to stay for the weekend.\"]] [:tr [:th.border.px-4 \"four-shot\"] [:th.border.px-4.font-normal \"#Person1 is in Changsha for a weekend.\"]])]], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}} {:path [6], :nextjournal/value [:div.font-sans.font-normal [:table.table-auto.rounded-sm [:tr [:th.border.px-4 \"Dialogue #\" 1245] [:th.border.px-4.font-normal [:details [:summary \"Expand\"] [:pre {:style {:white-space \"pre-wrap\"}} \"#Person1#: Hi, my name's Karl. My wife and I are moving in next door.\\n#Person2#: Hello, Karl. I'm Chuck Jones. We're going to be neighbors.\\n#Person1#: I'm happy to meet you. It seems everyone in town is so friendly.\\n#Person2#: This is a small town, and we like to be neighborly. We know everyone who lives around here.\\n#Person1#: Well, I'm from Chicago. There are few people take the time to get to know their neighbors.\\n#Person2#: So, tell me, Karl, why did you come all the way to Minnesota to live?\\n#Person1#: We wanted to live in a more peaceful community and have more space. Another reason is, we can afford to buy a home here, but we can't in Chicago!\"]]]] [:tr [:th.border.px-4 \"Human\"] [:th.border.px-4.font-normal \"Karl and his wife moved to Minnesota and greet their friendly neighbour Chuck Jones and tells him why they moved here.\"]] ([:tr [:th.border.px-4 \"zero-shot-1\"] [:th.border.px-4.font-normal \"The first person to meet you is Karl.\"]] [:tr [:th.border.px-4 \"zero-shot-2\"] [:th.border.px-4.font-normal \"The people in the town are friendly and they want to live in a peaceful community.\"]] [:tr [:th.border.px-4 \"one-shot\"] [:th.border.px-4.font-normal \"The people in the town are friendly and they want to live in a peaceful community.\"]] [:tr [:th.border.px-4 \"four-shot\"] [:th.border.px-4.font-normal \"The people in the town are friendly and they want to live in a peaceful community.\"]])]], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}} {:path [7], :nextjournal/value [:div.font-sans.font-normal [:table.table-auto.rounded-sm [:tr [:th.border.px-4 \"Dialogue #\" 371] [:th.border.px-4.font-normal [:details [:summary \"Expand\"] [:pre {:style {:white-space \"pre-wrap\"}} \"#Person1#: How can we get in touch with you?\\n#Person2#: Please call me or send e-mail. Could you please let me know when your organization can make a decision?\\n#Person1#: About one week.\\n#Person2#: I really appreciate your time and help. See you then.\"]]]] [:tr [:th.border.px-4 \"Human\"] [:th.border.px-4.font-normal \"#Person1# can tell #Person2# their organization's decision by phone or e-mail in about one week.\"]] ([:tr [:th.border.px-4 \"zero-shot-1\"] [:th.border.px-4.font-normal \"#Person1#: How can I get in touch with you? #Person2#: I'd like to talk to you about the decision.\"]] [:tr [:th.border.px-4 \"zero-shot-2\"] [:th.border.px-4.font-normal \"Person1 wants to know when the decision will be made.\"]] [:tr [:th.border.px-4 \"one-shot\"] [:th.border.px-4.font-normal \"#Person1 wants to get in touch with Person2 about one week after their decision.\"]] [:tr [:th.border.px-4 \"four-shot\"] [:th.border.px-4.font-normal \"#Person1 wants to know when his organization can make a decision.\"]])]], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}} {:path [8], :nextjournal/value [:div.font-sans.font-normal [:table.table-auto.rounded-sm [:tr [:th.border.px-4 \"Dialogue #\" 1282] [:th.border.px-4.font-normal [:details [:summary \"Expand\"] [:pre {:style {:white-space \"pre-wrap\"}} \"#Person1#: The air conditioning is not working! We need to call a handyman before we start to fry in here!\\n#Person2#: Dan is on top of that. I think they are also getting the handyman to fix the bathroom toilet that keeps clogging up.\\n#Person1#: That would be convenient. They might as well ask him to fix the electrical wiring. The circuit breakers keep going out all the time. It's really annoying!\\n#Person2#: Yeah you are right. This office is falling apart! Frank told me the other day that the gutters outside were clogged and that's why the parking lot was flooded.\\n#Person1#: I know! I was in ankle deep water trying to get to my car that day! The handyman definitely has his work cut out for him.\"]]]] [:tr [:th.border.px-4 \"Human\"] [:th.border.px-4.font-normal \"#Person1# wants a handyman to fix the air conditioner and it reminds #Person1# and #Person2# to fix other things as well.\"]] ([:tr [:th.border.px-4 \"zero-shot-1\"] [:th.border.px-4.font-normal \"The office is flooded.\"]] [:tr [:th.border.px-4 \"zero-shot-2\"] [:th.border.px-4.font-normal \"The air conditioning is not working. Dan is on top of that. Dan is also getting the handyman to fix the bathroom toilet. Frank told the other day that the gutters outside were clogged and that the parking lot was flooded.\"]] [:tr [:th.border.px-4 \"one-shot\"] [:th.border.px-4.font-normal \"The air conditioning is not working and the bathroom toilet is clogged up.\"]] [:tr [:th.border.px-4 \"four-shot\"] [:th.border.px-4.font-normal \"The air conditioning is not working and the bathroom toilet is clogged up.\"]])]], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}} {:path [9], :nextjournal/value [:div.font-sans.font-normal [:table.table-auto.rounded-sm [:tr [:th.border.px-4 \"Dialogue #\" 485] [:th.border.px-4.font-normal [:details [:summary \"Expand\"] [:pre {:style {:white-space \"pre-wrap\"}} \"#Person1#: Hi, Fanny.\\n#Person2#: Hi, Andy.\\n#Person1#: Are you feeling OK? You sound a little tired this morning.\\n#Person2#: I did not sleep much last night. I really feel bad. It was a crazy night.\\n#Person1#: What happened?\\n#Person2#: I had a bad dream. I was walking alone in the graveyard, and suddenly all the ghosts jumped out of their graves. They began to chase me through the graveyard and shouted that they wanted my blood.\\n#Person1#: Oh, what a nightmare! Then what happened?\\n#Person2#: My mother woke me up. She had heard me crying out for help.\\n#Person1#: You have got a great mother.\\n#Person2#: I felt embarrased. After all, I am 18 years old. Mom gave me some chocolate cookies and a glass of milk.\\n#Person1#: That sounds good!\\n#Person2#: Yeah, but i was afraid to fall back asleep. I am worrying about getting into the University of Michigan.\\n#Person1#: Me too. But I tell myself that if they don't accept me, another school will.\"]]]] [:tr [:th.border.px-4 \"Human\"] [:th.border.px-4.font-normal \"Fanny had a bad dream last night. She is worried about getting into the University of Michigan. Andy comforts her.\"]] ([:tr [:th.border.px-4 \"zero-shot-1\"] [:th.border.px-4.font-normal \"The ghosts chased the 18-year-old through the graveyard and shouted that they wanted my blood.\"]] [:tr [:th.border.px-4 \"zero-shot-2\"] [:th.border.px-4.font-normal \"Person1 is worried about getting into the University of Michigan.\"]] [:tr [:th.border.px-4 \"one-shot\"] [:th.border.px-4.font-normal \"Fanny and Andy are feeling a little tired.\"]] [:tr [:th.border.px-4 \"four-shot\"] [:th.border.px-4.font-normal \"Person1 is worried about getting into the University of Michigan.\"]])]], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}], :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-coll, :opening-paren \"[\", :closing-paren (\"]\"), :page-size 20, :hash \"5dsKpRYUuGnwVK3BPfAoiJqkhVbPzH\"}, :nextjournal/opts {:id \"dlai.lab1/big-comparison-result-result\"}}, :nextjournal/blob-id \"5drCA21k6VKzXnzweDw8oJM3Jo6opM\"}, :nextjournal/opts {:id \"dlai.lab1/big-comparison-result-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"dlai.lab1/markdown-5drepB6N2GQgkrBZYwt2TFp5bnHi8r\"} [:p [:<> \"There you go. This concludes our Lab 1 imitation. Judge it for yourself, but my personal conclusion is that this T5 base model is not very good at grabbing nuances of dialogues, but now you have everything you need to experiment with other models without leaving your cozy Clojure REPL and Clerk.\"]]], :nextjournal/opts {:id \"dlai.lab1/markdown-5drepB6N2GQgkrBZYwt2TFp5bnHi8r\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}}]}, :nextjournal/viewer {:name nextjournal.clerk.viewer/notebook-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-notebook, :hash \"5duAFDxE4sCnRX71Wo6zeCpC9C3djE\"}}}, :path->url {\"src/dlai/lab1.clj\" \"\"}, :current-path \"src/dlai/lab1.clj\", :resource->url {\"/js/viewer.js\" \"https://storage.clerk.garden/nextjournal/clerk-assets@Me6c4a1aFwAPMjnGU96CERc3zTT/viewer.js?immutable=true\"}, :index \"src/dlai/lab1.clj\"}".replaceAll('nextjournal.clerk.view/escape-closing-script-tag', 'script')
viewer.init(viewer.read_string(state))
</script></body></html>